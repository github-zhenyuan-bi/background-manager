<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>${(db_constants.login_page_title)!'后台登陆'}</title>

        <!-- App Icons -->
        <link rel="shortcut icon" href="/assets/images/favicon.ico">

        <!-- App css -->
        <#include "/template/css/bootstrap-css.html" />
		
    </head>


    <body>

        <!-- Loader -->
        <div id="preloader"><div id="status"><div class="spinner"></div></div></div>

        <!-- Begin page -->
        <div class="accountbg"></div>
        <div class="wrapper-page" style="margin: 0 auto;">


			<!-- ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ 登陆盒子 开始 ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ -->
            <div class="card" style="margin-top: 15%;">
                <div class="card-body">
					
					<!-- ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ 名称 开始 ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ -->
                    <h3 class="text-center m-0" style="color: #595455; letter-spacing: 10px;font-family: cursive;padding: 25px 0 10px 0;">
                    	<strong>${(db_constants.scriptName)!'店名'}</strong>
                        <!-- <a href="index.html" class="logo logo-admin"><img src="/assets/images/logo_dark.png" height="30" alt="logo"></a> -->
                    </h3>
					<!-- ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ 名称 结束 ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ -->
					
                    <div class="p-3">
                    	<!-- ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ 副标题 开始 ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ -->
                        <h4 class="text-muted font-18 text-center">欢迎登陆</h4>
                        <p class="text-muted text-center">${(db_constants.scriptName)!'店名'}后台管理系统</p>
						<!-- ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ 副标题 结束 ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ -->
						
						
						<!-- ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ 登陆表单 开始 ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ -->
                        <form class="form-horizontal m-t-30" data-parsley-validate>
                        	  
                            <div class="form-group">
                                <label for="username">用户名</label>
                                <input type="text" required class="form-control" autofocus="autofocus"
                                		id="username" name="username" value="${(username)!}" placeholder="请输入用户名"
							           data-parsley-required="true"
							           data-parsley-required-message="用户名不可为空"></div>

                            <div class="form-group">
                                <label for="password">密码</label>
                                <input type="password" class="form-control" id="password" name="password" 
                                		placeholder="请输入密码" autocomplete="false"
							           data-parsley-required="true"
							           data-parsley-required-message="密码不可为空"></div>

                            <div class="form-group row m-t-20">
                                <!-- <div class="col-sm-6">
                                    <div class="custom-control custom-checkbox">
                                        <input type="checkbox" class="custom-control-input" id="customControlInline">
                                        <label class="custom-control-label" for="customControlInline">记住我</label>
                                    </div>
                                </div> -->
                                <div class="col-sm-12 p-3">
                                    <button id="submitBtn" class="btn btn-primary w-md waves-effect waves-light btn-block" type="button" onclick="submitForm(this)">登陆</button>
                                </div>
                            </div>

                            <div class="form-group m-t-10 mb-0 row">
                                <div class="col-12 m-t-20">
                                    <a href="pages-recoverpw.html" class="text-muted"><i class="mdi mdi-lock"></i>忘记密码?</a>
                                </div>
                            </div>
                        </form>
                        <!-- ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ 登陆表单 结束 ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ -->
                        
                    </div>

                </div>
            </div>
            <!-- ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ 登陆盒子 结束 ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ -->
            

            <div class="m-t-40 text-center">
                <!-- <p>还没有账号 ? <a href="pages-register.html" class="font-500 font-14 text-primary font-secondary"> 注册账号 </a> </p> -->
                <p>${(db_constants.footer_text)!'© bzy.'}</p>
            </div>

        </div>

        <!-- jQuery  -->
        <#include "/template/js/jquery-plugins-js.html" />
        <#include "/template/js/bootstrap-js.html" />
        <#include "/template/js/bootstrap-jqAlert-js.html" />
        <#include "/template/js/md5-and-parsley.html" />
        <!-- App js -->
        <script src="/assets/js/app.js"></script>
        
		<script type="text/javascript">
			$(document).ready(function() {
				// 加载验证机制
	            $('form').parsley();
	        });
			
			$(document).keyup(function(event){
			    if(event.keyCode ==13){
			        $("#submitBtn").trigger("click");
			    }
			});
			
			function submitForm(btn) {
				// 表单信息 前端验证通过
				var isFormValidPass =  $('form').parsley().validate()
				if (!isFormValidPass) return;
				
				var _btn  = $(btn);
				var _form = _btn.parents("form");
				
				// 密码加密
				var _password = _form.find("input#password");
            	_password.val(hex_md5(_password.val()));
            	
            	// 搜集参数
				var params = getFormParams(_form);
				
				// 提交表单
				$.post("/login", params, function(res, textStatus, request) {
					if (res.code === 200) {
						window.location.href = res.data;
					} else {
						_password.val("");
						_password.focus();
						var options={
	    					content: res.msg,
	    					type : 'error',//info,success,warning,error
	    				}
						$.jqAlert_small(options);
					}
				});
			}
			
			
			// 收集表单下的全部参数
			function getFormParams(_form) {
				var params = {};
				_form.find("input").each(function() {
					if (this.name)
						params[this.name] = this.value;
				});
				return params;
			}
		</script>
    </body>
</html>